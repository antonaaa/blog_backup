---
title: 用户数据报协议（User Datagram Protocol）
date: 2016-08-09 09:17:33
tags: 
- 计算机网络
- 运输层
- UDP
categories: 计算机网络
---

> UDP是不可靠的传输层协议，不像TCP那样需要建立连接，而建立连接的本质是在内存中维护一些数据结构，所以UDP所需的系统资源比TCP少。

<!-- more -->

## UDP的首部字段

UDP首部字段只有非常简单的4个字段，而且每个字段都有有用的，加起来共8个字节。UDP首部的检验和的计算和ARP首部，IP首部检验和的计算略有不同，具体看 [UDP首部检验和](/2016/08/08/udp-header-check-sum)。

![UDP首部字段](UDP_packet_header.png)

## UDP的工作原理

使用UDP发送数据报时，只要填充其简单的首部字段然后加上数据部分交给IP层就可以了。然后IP层将其转发出去，至于到底有没有转发到目的地，发送方并不知道。


## UDP的优缺点
+ UDP是**无连接**的，即发送数据之前不需要建立连接，因此减少了发送数据前的时延。

+ UDP是**尽最大努力交互**的，即不可靠交互，所以不需要像TCP那样维护复杂的连接状态表（这里面有许多维护连接所需要的参数）。

+ UDP是**面向报文**的，即UDP只在应用层交下来的报文前面加上首部就交付给IP层了。所以UDP一次交付一个完整的报文，所以如果应用层的数据太大了，那么UDP把它交给IP层后，IP层可能对其进行分片，这会降低IP层的效率。

## UDP的应用场景

UDP没有拥塞控制机制和重传机制，所以对于发送方来说它可以始终以一个统一的速率向目的方发送数据，因此UDP可以用在一些实时性比较高且不在意一些丢包的场景，比如视频电话，直播等。
* 如果视频电话使用TCP实现，那么会出现前面丢了一个包，那么后面收到的包都不会被播放，那么结果就是视频卡在那里，直到该数据报被重传成功为止。

* 如果使用UDP实现，那么丢了一个包，发送方不会知道丢包了，所以会继续发送接下来的包，而接收方也不知道丢包了，也会继续接收并播放接下来的包。

说得很简单，其实很难，UDP发送包是有序发送的，但是因为网络环境的缘故接收方接收到的包并不是有序，所以接收方的应用层在收到数据之后要对其进行排序。
